<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Soma-workflow concepts &#8212; soma-workflow version 3.3 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/classic.css?v=514cf933" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=eafc0fe6" />
    
    <script src="_static/documentation_options.js?v=3eb8911e"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    
    <link rel="icon" href="_static/icon_small.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Important changes in Soma-Workflow 3" href="changes_swf3.html" />
    <link rel="prev" title="Soma-workflow: A unified and simple interface to parallel computing resource" href="index.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="changes_swf3.html" title="Important changes in Soma-Workflow 3"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Soma-workflow: A unified and simple interface to parallel computing resource"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">soma-workflow version 3.3 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Soma-workflow concepts</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="soma-workflow-concepts">
<span id="concepts"></span><h1>Soma-workflow concepts<a class="headerlink" href="#soma-workflow-concepts" title="Link to this heading">¶</a></h1>
<nav class="contents local" id="id1">
<p class="topic-title">Soma-workflow concepts</p>
<ul class="simple">
<li><p><a class="reference internal" href="#overview" id="id6">Overview</a></p></li>
<li><p><a class="reference internal" href="#quick-start-with-the-mono-process-application" id="id7">Quick start with the mono process application</a></p></li>
<li><p><a class="reference internal" href="#more-features-with-the-client-server-application" id="id8">More features with the client-server application</a></p>
<ul>
<li><p><a class="reference internal" href="#file-transfer" id="id9">File Transfer</a></p></li>
<li><p><a class="reference internal" href="#shared-resource-path" id="id10">Shared Resource Path</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="overview">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Overview</a><a class="headerlink" href="#overview" title="Link to this heading">¶</a></h2>
<p>Soma-workflow was built to make easier the use of parallel computing resources
for researchers.</p>
<p>Although Soma-workflow can be used to run individual jobs, it focuses on the
execution of coarse-grained parallelized computational processes which are made
of “long” sub-tasks (from about a minute to several days or weeks) which do
not need to communicate together.</p>
<p>The coarse-grained parallelized computational processes are described by
executable <strong>workflows</strong>. Each sub-task is described by a program command line
(any program) and is called <strong>job</strong>. A workflow description includes the
definition of a set of job and their execution dependencies.</p>
<blockquote>
<div><figure class="align-default" id="id2">
<a class="reference internal image-reference" href="_images/workflow_example.png"><img alt="_images/workflow_example.png" src="_images/workflow_example.png" style="width: 600.0px; height: 196.79999999999998px;" /></a>
<figcaption>
<p><span class="caption-text"><em>Workflow example. The jobs are represented by gray boxes and the
dependencies by arrows. A workflow organizes the execution of a set
of jobs defining execution dependencies between jobs. A dependency from a
job A to a job B means that the job A will not start before the job B is
done.</em></span><a class="headerlink" href="#id2" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</div></blockquote>
<p>These workflows can be created directly by the user or generated by
external software which provide a higher level description of workflows (semantic
description of sub-task, typed input and output…), like
<a class="reference external" href="https://brainvisa.info">BrainVISA</a> for example.
<strong>See</strong> <a class="reference internal" href="workflow_creation.html#workflow-creation-api"><span class="std std-ref">Workflow creation API</span></a>.</p>
<blockquote>
<div><figure class="align-default" id="id3">
<a class="reference internal image-reference" href="_images/position.png"><img alt="_images/position.png" src="_images/position.png" style="width: 261.5px; height: 331.0px;" /></a>
<figcaption>
<p><span class="caption-text"><em>Position of Soma-workflow: the workflows can be created by user or generated by external software.</em></span><a class="headerlink" href="#id3" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id4">
<a class="reference internal image-reference" href="_images/API_overview.png"><img alt="_images/API_overview.png" src="_images/API_overview.png" style="width: 509.5px; height: 246.5px;" /></a>
<figcaption>
<p><span class="caption-text"><em>Example of the simple creation a workflow using the Python API.</em></span><a class="headerlink" href="#id4" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</div></blockquote>
<p>Soma-workflow interacts with computing resources, to execute,
control and monitor workflows and jobs:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>execution</strong>: Soma-workflow submits automatically each workflow job as soon as possible considering the execution dependencies.</p></li>
<li><p><strong>monitoring</strong>: the current status of each job is available at any time (in the queue, running, done…)</p></li>
<li><p><strong>control</strong>: the jobs can be canceled or killed. The workflows can be stopped and restarted.</p></li>
</ul>
</div></blockquote>
<p>All these functionalities are available using the <a class="reference internal" href="client_API.html#client-api"><span class="std std-ref">Python API</span></a> or the <a class="reference internal" href="gui.html#gui"><span class="std std-ref">Graphical User Interface</span></a> (GUI).
The GUI is especially of interest to monitor workflows execution.</p>
<p>With the same interfaces (API and GUI), Soma-workflow enables the interaction with a wide range
of computing resources:</p>
<blockquote>
<div><ul class="simple">
<li><p>multiple core machine</p></li>
<li><p>cluster via <a class="reference external" href="http://www.drmaa.org/">DRMAA</a>  (unified interface for DRMS)</p></li>
<li><p><strong>New in version 2.4:</strong> cluster via MPI (beta version), c.f. <a class="reference internal" href="MPI_workflow_runner.html#mpi-workflow-runner"><span class="std std-ref">MPI workflow runner</span></a></p></li>
</ul>
</div></blockquote>
<p>Note that Soma-workflow is not a resource manager it has to interact with the
system managing the computing resource (<strong>DRMS</strong>: Distributed Resource
Management System) if it exists.</p>
<p>Soma-workflow enables the user to use <strong>remote computing resources</strong>. The communication is
done transparently for the user and securely within a ssh tunnel. In case the
computing resource and the user’s machine do not have a shared file system,
Soma-workflow provides several tools:</p>
<blockquote>
<div><ul class="simple">
<li><p>File transfers: allow the transfer of files or directories from or to the remote resource. The file transfers status are taken into account when a workflow is executed.</p></li>
<li><p>Shared resource path: maps a path which is valid on the user machine with a path which is valid on the computing resource thanks to “translations” files.</p></li>
</ul>
</div></blockquote>
<p>The file transfer and shared resource path objects can be used instead of any path
in the definition of jobs or workflows (see <a class="reference internal" href="examples.html#examples"><span class="std std-ref">Examples</span></a>).</p>
</section>
<section id="quick-start-with-the-mono-process-application">
<span id="quick-start"></span><h2><a class="toc-backref" href="#id7" role="doc-backlink">Quick start with the mono process application</a><a class="headerlink" href="#quick-start-with-the-mono-process-application" title="Link to this heading">¶</a></h2>
<p>To provide you quickly with a functional application, your own multiple core
machine can be used directly and without any configuration to distribute
computation.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="https://brainvisa.info/soma-workflow">Soma-workflow main page</a> for installation.</p>
</div>
<p>Soma-workflow runs as a regular mono process application on your local machine.
In this configuration Soma-workflow should not be stopped while workflows or jobs
are running. If the application is closed, the workflow execution is stopped and
the current running jobs might be lost if you are using a cluster (on some
systems you will need to kill the jobs using the DRMS command). However, you
will be able to restart the workflow in an other session.</p>
<p>Soma-workflow can be used as a mono process application on clusters too (see
<a class="reference internal" href="install_config.html#light-mode-config"><span class="std std-ref">configuration and installation section</span></a>). The
application must run on a machine which is configured for submission.</p>
</section>
<section id="more-features-with-the-client-server-application">
<span id="client-server-application-concept"></span><h2><a class="toc-backref" href="#id8" role="doc-backlink">More features with the client-server application</a><a class="headerlink" href="#more-features-with-the-client-server-application" title="Link to this heading">¶</a></h2>
<p>Compared to the mono process application, the client-server mode introduces two interesting
features:</p>
<ul class="simple">
<li><p><strong>Remote access</strong> to computing resource through a client application.</p></li>
<li><p><strong>Disconnections</strong>: the client application can be closed at any time, it won’t stop the execution of workflows.</p></li>
</ul>
<figure class="align-default" id="id5">
<a class="reference internal image-reference" href="_images/architecture_overview.png"><img alt="_images/architecture_overview.png" src="_images/architecture_overview.png" style="width: 570.0px; height: 340.0px;" /></a>
<figcaption>
<p><span class="caption-text"><em>Overview of soma-workflow architecture in the client-server mode</em></span><a class="headerlink" href="#id5" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>There are three main processes in the client-server mode:</p>
<ul class="simple">
<li><p>The <strong>workflow controller</strong> process runs on the client side (on the user
machine). When it is started, it connects to the remote machine and creates
a workflow engine process. The two processes communicate together through a
secured channel (ssh tunnel).</p></li>
<li><p>The <strong>workflow engine</strong> runs on the computing resource side with the user’s
rights (no admin rights). It processes the submitted workflows, submit,
control and monitor jobs. It also updates the soma-workflow database at
regular time interval with the status of the jobs, workflows and file
transfers.</p></li>
<li><p>The <strong>workflow database server</strong> runs on the computing resource side as a
soma-workflow administrator user (no need to be the root user, not any
special rights are needed). It stores and queries all the informations
about file transfers, jobs and workflows, to and from the soma-workflow
database file.</p></li>
</ul>
<p>When the client application is closed (the workflow controller process stops),
the workflow engine process keeps on running until the submitted workflows and
jobs are done.</p>
<p>Each time a client application starts, a workflow engine process is created on
the computing resource side. If no workflow or job were submitted with the
client application or if they all ended, the workflow engine process stops as
soon as the client application is closed.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>configuration and installation section for the <a class="reference internal" href="install_config.html#server"><span class="std std-ref">server</span></a> and the <a class="reference internal" href="install_config.html#client-intall-config"><span class="std std-ref">client</span></a></p>
</div>
<section id="file-transfer">
<span id="file-transfers-concept"></span><h3><a class="toc-backref" href="#id9" role="doc-backlink">File Transfer</a><a class="headerlink" href="#file-transfer" title="Link to this heading">¶</a></h3>
<blockquote>
<div><p>The file transfers are optional. However, they can be useful when the user’s file
system is not shared with the computing resource.</p>
<p>The file transfer objects allow the transfer of files or directories to and from
the computing resource file system.</p>
<p>A file transfer object is a mapping between a file path which is valid on
the user file system and a file path which is valid on the computing resource
file system. There is no need for the user to specify a valid path on the
computing resource. Soma-workflow handles the choice of this path within a
configured directory.</p>
<p>The file transfer object can be used instead of any regular path in the
definitions of jobs and workflows.
The jobs using file transfers in their program command line, has to state
which file transfers are input, output or both. That way soma-workflow
waits for all the input files to exist on the computing resource before
submitting the job to the resource.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="examples.html#file-transfer-examples"><span class="std std-ref">file transfer examples</span></a> in the example section.</p>
</div>
</div></blockquote>
</section>
<section id="shared-resource-path">
<span id="shared-resource-path-concept"></span><h3><a class="toc-backref" href="#id10" role="doc-backlink">Shared Resource Path</a><a class="headerlink" href="#shared-resource-path" title="Link to this heading">¶</a></h3>
<blockquote>
<div><p>As file transfers, shared resource paths are optional but can be useful when
the user’s file system is not shared by the computing resource. Shared Resource
Path are useful when a your data was already transfered on the computing resource
side.</p>
<p>Shared resource path objects can be used instead of any regular path in the
definition of jobs and workflows. Soma-workflow looks up into translation
files configured on the computing resource side to recover the corresponding
valid path.</p>
<p>Several translation files can be configured, and each of them is associated to
a namespace (see <a class="reference internal" href="install_config.html#conf-server-option"><span class="std std-ref">Configuration items optional on the server side:</span></a>).</p>
<p>For example, if you want to configure file translation for an application “MyApp”,
you will configure the translation file “my_app_translation” under the namespace
“MyApp”. The content the translation file is a list of unique identifier
associated to directory paths. For examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">5</span><span class="n">ee1e9a0</span><span class="o">-</span><span class="mi">5959</span><span class="o">-</span><span class="mf">11e0</span><span class="o">-</span><span class="mf">80e3</span><span class="o">-</span><span class="mi">0800200</span><span class="n">c9a66</span>  <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">myname</span><span class="o">/</span><span class="n">data_for_my_app</span><span class="o">/</span><span class="n">data1</span><span class="o">/</span>
<span class="mi">922</span><span class="n">ba490</span><span class="o">-</span><span class="mi">5959</span><span class="o">-</span><span class="mf">11e0</span><span class="o">-</span><span class="mf">80e3</span><span class="o">-</span><span class="mi">0800200</span><span class="n">c9a66</span>  <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">myname</span><span class="o">/</span><span class="n">data_for_my_app</span><span class="o">/</span><span class="n">data2</span><span class="o">/</span>
<span class="n">a7623ef0</span><span class="o">-</span><span class="mi">5959</span><span class="o">-</span><span class="mf">11e0</span><span class="o">-</span><span class="mf">80e3</span><span class="o">-</span><span class="mi">0800200</span><span class="n">c9a66</span>  <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">myname</span><span class="o">/</span><span class="n">data_for_my_app</span><span class="o">/</span><span class="n">data3</span><span class="o">/</span>
</pre></div>
</div>
<p>One can use more simple identifiers since each translation file is included
into a namespace:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data1_dir</span>  <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">myname</span><span class="o">/</span><span class="n">data_for_my_app</span><span class="o">/</span><span class="n">data1</span><span class="o">/</span>
<span class="n">data2_dir</span>  <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">myname</span><span class="o">/</span><span class="n">data_for_my_app</span><span class="o">/</span><span class="n">data2</span><span class="o">/</span>
<span class="n">data3_dir</span>  <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">myname</span><span class="o">/</span><span class="n">data_for_my_app</span><span class="o">/</span><span class="n">data3</span><span class="o">/</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="examples.html#shared-resource-path-examples"><span class="std std-ref">shared resource path examples</span></a> in the example section.</p>
</div>
</div></blockquote>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/logo_white_small.png" alt="Logo"/>
            </a></p>
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Soma-workflow concepts</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#quick-start-with-the-mono-process-application">Quick start with the mono process application</a></li>
<li><a class="reference internal" href="#more-features-with-the-client-server-application">More features with the client-server application</a><ul>
<li><a class="reference internal" href="#file-transfer">File Transfer</a></li>
<li><a class="reference internal" href="#shared-resource-path">Shared Resource Path</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="index.html"
                          title="previous chapter">Soma-workflow: A unified and simple interface to parallel computing resource</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="changes_swf3.html"
                          title="next chapter">Important changes in Soma-Workflow 3</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/concepts.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="changes_swf3.html" title="Important changes in Soma-Workflow 3"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Soma-workflow: A unified and simple interface to parallel computing resource"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">soma-workflow version 3.3 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Soma-workflow concepts</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2011-2021 CEA, Neurospin, France, CATI, France.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.5.
    </div>
  </body>
</html>